!function(t){function e(e,i){var o=this;this.notifications={loading:"Loading high resolution image...",error:"There has been a problem with loading the image!"},this.settings=t.extend({selector:{preview:"#preview-zoom",window:"#window-zoom"}},i);var n=t("img:first",e),s=null,r=null,a=new Image,f=!1,c=null;this.init=function(i){c="undefined"!=typeof i?i:t(e).attr("data-image"),o.reset().attachEventListener()},this.attachEventListener=function(){return t(e).on({mouseover:function(){o.start()},mousemove:function(t){o.recognizeMouseMovement(t)}}),o},this.detachEventListener=function(){return t(e).off(),o},this.start=function(){o.modifyCursorAppearance("auto"),f?o.showZoomWindow():(o.modifyCursorAppearance("progress"),o.showNotification(o.notifications.loading),o.waitUntilResourceIsLoaded(c))},this.reset=function(){return f=!1,o.fadeOut().detachEventListener()},this.fadeOut=function(){return t(o.settings.selector.window).fadeOut(),t(o.settings.selector.preview).fadeOut(),o},this.deferredFadeOut=function(t){setTimeout(function(){o.fadeOut()},t)},this.waitUntilResourceIsLoaded=function(e){return a.src=e,t(a).load(function(){f=!0,o.calculateRelationOfImageGeometry(this),o.start()}).error(function(){o.showErrorNotification()}),o},this.showZoomWindow=function(){t(o.settings.selector.window).html(a).fadeIn()},this.showPreview=function(e){t(o.settings.selector.preview).css(e).fadeIn()},this.calculateRelationOfImageGeometry=function(t){r=t.width/n.width(),s=t.height/n.height()},this.recognizeMouseMovement=function(e){if(f)if(o.previewRemainsInScope(e)){var i=(e.pageX-n.offset().left)*r-t(o.settings.selector.window).width()/2,a=(e.pageY-n.offset().top)*s-t(o.settings.selector.window).height()/2;t(o.settings.selector.window).children("img:first").css({left:-i,top:-a}),o.showPreview(o.getPositionPropertiesPreview(e)),o.showZoomWindow()}else o.fadeOut()},this.getPositionPropertiesPreview=function(e){var i={height:50,width:50},o=t(n).offsetParent().offset();return t.extend(i,{left:e.pageX-i.width/2-o.left,top:e.pageY-i.height/2-o.top})},this.previewRemainsInScope=function(e){var i=t(n);return e.pageX<i.offset().left||e.pageX>i.offset().left+i.width()||e.pageY<i.offset().top||e.pageY>i.offset().top+i.height()?!1:!0},this.showNotification=function(e){return t(o.settings.selector.window).fadeIn().text(e),o},this.showErrorNotification=function(){o.modifyCursorAppearance("auto").showNotification(o.notifications.error).deferredFadeOut(2e3)},this.modifyCursorAppearance=function(i){return t(e).css("cursor",i),o},o.init()}t.fn.easyZoom=function(i){return this.each(function(){t.data(this,"easyZoom",new e(this,i))})}}(jQuery);
